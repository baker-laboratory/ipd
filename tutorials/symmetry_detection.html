
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Understanding Symmetry Detection &#8212; IPD 0.3.8 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=d97aba73" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=c1cae59a"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'tutorials/symmetry_detection';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cumulative sums primer and rapid contact matrix processing" href="contact_matrix.html" />
    <link rel="prev" title="Body and SymBody Objects" href="working_with_bodies.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
<div class="bd-header__inner bd-page-width">
  <button class="pst-navbar-icon sidebar-toggle primary-toggle" aria-label="Site navigation">
    <span class="fa-solid fa-bars"></span>
  </button>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
  
    <p class="title logo__title">IPD 0.3.8 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev_guide/index.html">
    IPD Dev Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../modules.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../_apidoc/modules.html">
    ipd
  </a>
</li>

  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
        </div>
      
      
        <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button>
    </div>
  

  
    <button class="pst-navbar-icon sidebar-toggle secondary-toggle" aria-label="On this page">
      <span class="fa-solid fa-outdent"></span>
    </button>
  
</div>

    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          
          
            <div class="navbar-item">
<nav>
  <ul class="bd-navbar-elements navbar-nav">
    
<li class="nav-item current active">
  <a class="nav-link nav-internal" href="index.html">
    Tutorials
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../examples/index.html">
    Examples Gallery
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../dev_guide/index.html">
    IPD Dev Guide
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../modules.html">
    API Reference
  </a>
</li>


<li class="nav-item ">
  <a class="nav-link nav-internal" href="../_apidoc/modules.html">
    ipd
  </a>
</li>

  </ul>
</nav></div>
          
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="using_homog.html">Homogeneous Coordinates and ipd.hnumpy / ipd.htorch</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_atoms.html">Working with .cif files and atoms</a></li>
<li class="toctree-l1"><a class="reference internal" href="processing_assemblies.html">Determining Biological Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="working_with_bodies.html">Body and SymBody Objects</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Understanding Symmetry Detection</a></li>
<li class="toctree-l1"><a class="reference internal" href="contact_matrix.html">Cumulative sums primer and rapid contact matrix processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="class_decorators.html">Class Decorators Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="function_decorators.html">Function Decorator Tutorial</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">

<nav aria-label="Breadcrumb" class="d-print-none">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="index.html" class="nav-link">Tutorials</a></li>
    
    <li class="breadcrumb-item active" aria-current="page"><span class="ellipsis">Understanding Symmetry Detection</span></li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="understanding-symmetry-detection">
<span id="understanding-sym-detect"></span><h1><a class="toc-backref" href="#id1" role="doc-backlink">Understanding Symmetry Detection</a><a class="headerlink" href="#understanding-symmetry-detection" title="Link to this heading">#</a></h1>
<nav class="contents" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#understanding-symmetry-detection" id="id1">Understanding Symmetry Detection</a></p>
<ul>
<li><p><a class="reference internal" href="#overview" id="id2">Overview</a></p></li>
<li><p><a class="reference internal" href="#usage-example" id="id3">Usage Example</a></p></li>
<li><p><a class="reference internal" href="#symmetry-detection-pipeline" id="id4">Symmetry Detection Pipeline</a></p>
<ul>
<li><p><a class="reference internal" href="#unique-symaxes" id="id5">Unique Symaxes</a></p></li>
<li><p><a class="reference internal" href="#symmetry-from-atoms" id="id6">Symmetry from Atoms</a></p></li>
<li><p><a class="reference internal" href="#symmetry-from-frames" id="id7">Symmetry from Frames</a></p></li>
<li><p><a class="reference internal" href="#the-syminfo-object" id="id8">The SymInfo Object</a></p></li>
<li><p><a class="reference internal" href="#advanced-topics" id="id9">Advanced Topics</a></p></li>
<li><p><a class="reference internal" href="#related-functions" id="id10">Related Functions</a></p></li>
<li><p><a class="reference internal" href="#conclusion" id="id11">Conclusion</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="overview">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Overview</a><a class="headerlink" href="#overview" title="Link to this heading">#</a></h2>
<p>The <cite>ipd.sym.sym_detect</cite> module provides tools to automatically identify symmetry in molecular structures and transformation frames. The symmetry is inferred from spatial transformations between subunits (e.g., protein chains), and classified into cyclic, dihedral, helical, and cage symmetries (T, O, I).</p>
<p>This document explains:</p>
<ul class="simple">
<li><p>The <cite>detect()</cite> function</p></li>
<li><p>The <cite>SymInfo</cite> result class</p></li>
<li><p>How symmetry elements are extracted from transformation frames</p></li>
<li><p>How equivalent symmetry axes are identified via <cite>unique_symaxes</cite></p></li>
</ul>
<p>Symmetry detection begins with either:</p>
<ul class="simple">
<li><p>A <strong>stack of 4×4 transformation matrices</strong> (e.g., from a symmetric assembly)</p></li>
<li><p>A <strong>list of Biotite AtomArray objects</strong> (e.g., protein chains in a complex)</p></li>
</ul>
<p>These are passed to <cite>ipd.sym.detect</cite>:</p>
<p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.detect" title="ipd.sym.sym_detect.detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.detect()</span></code></a></p>
<p>The function delegates to:</p>
<ul class="simple">
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">syminfo_from_frames()</span></code> — if given transformations</p></li>
<li><p><code class="xref py py-func docutils literal notranslate"><span class="pre">syminfo_from_atomslist()</span></code> — if given atoms</p></li>
</ul>
<p>The output is a <cite>SymInfo</cite> object containing all symmetry classification and geometric information.</p>
</section>
<section id="usage-example">
<span id="printed-syminfo"></span><h2><a class="toc-backref" href="#id3" role="doc-backlink">Usage Example</a><a class="headerlink" href="#usage-example" title="Link to this heading">#</a></h2>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span><span class="w"> </span><span class="nn">ipd</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">chains</span> <span class="o">=</span> <span class="n">ipd</span><span class="o">.</span><span class="n">atom</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;2tbv&quot;</span><span class="p">,</span> <span class="n">assembly</span><span class="o">=</span><span class="s2">&quot;largest&quot;</span><span class="p">,</span> <span class="n">het</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">chainlist</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sinfo</span> <span class="o">=</span> <span class="n">ipd</span><span class="o">.</span><span class="n">sym</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">chains</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sinfo</span><span class="o">.</span><span class="n">symid</span>
<span class="go">&#39;I&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sinfo</span><span class="o">.</span><span class="n">t_number</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sinfo</span>
<span class="go">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓</span>
<span class="go">┃ SymInfo 2TBV                                                                 ┃</span>
<span class="go">┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩</span>
<span class="go">│ ┏━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓ │</span>
<span class="go">│ ┃ symid      ┃ guess      ┃ symcen        ┃ origin                         ┃ │</span>
<span class="go">│ ┡━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩ │</span>
<span class="go">│ │ I          │ I          │   0.000       │ [[-0.  1.  0.  0.]             │ │</span>
<span class="go">│ │            │            │   0.000       │  [-1. -0.  0. -0.]             │ │</span>
<span class="go">│ │            │            │  -0.000       │  [ 0. -0.  1. -0.]             │ │</span>
<span class="go">│ │            │            │               │  [ 0.  0.  0.  1.]]            │ │</span>
<span class="go">│ └────────────┴────────────┴───────────────┴────────────────────────────────┘ │</span>
<span class="go">│ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━┓ │</span>
<span class="go">│ ┃ has_translation           ┃ axes concurrent           ┃ axes dists       ┃ │</span>
<span class="go">│ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━┩ │</span>
<span class="go">│ │ False                     │ True                      │ [0. 0. 0.]       │ │</span>
<span class="go">│ └───────────────────────────┴───────────────────────────┴──────────────────┘ │</span>
<span class="go">│ ┏━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┓ │</span>
<span class="go">│ ┃ T      ┃ asu rms   ┃ asu seq match     ┃ asu frames    ┃ all frames      ┃ │</span>
<span class="go">│ ┡━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━┩ │</span>
<span class="go">│ │    3   │ [2.061]   │ [0.942]           │ [3, 4, 4]     │ [60, 3, 4, 4]   │ │</span>
<span class="go">│ └────────┴───────────┴───────────────────┴───────────────┴─────────────────┘ │</span>
<span class="go">│ ┏━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━┳━━━━━━━━━━┓ │</span>
<span class="go">│ ┃ C  ┃ axis                       ┃ ang       ┃ cen             ┃ hel      ┃ │</span>
<span class="go">│ ┡━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━╇━━━━━━━━━━┩ │</span>
<span class="go">│ │ 5  │ [-0.     0.526  0.851]     │   1.257   │ [ 0.  0. -0.]   │  -0.000  │ │</span>
<span class="go">│ │ 2  │ [-0.  0.  1.]              │   3.142   │ [-0.  0. -0.]   │  -0.000  │ │</span>
<span class="go">│ │ 3  │ [0.357 0.    0.934]        │   2.094   │ [0. 0. 0.]      │   0.000  │ │</span>
<span class="go">│ └────┴────────────────────────────┴───────────┴─────────────────┴──────────┘ │</span>
<span class="go">│ ┏━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━┳━━━━━━━━━━━━━┳━━━━━━━━━━┳━━━━━━━━━━━┓ │</span>
<span class="go">│ ┃ Geom Tests           ┃ tol          ┃ frac        ┃ total    ┃ passes    ┃ │</span>
<span class="go">│ ┡━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━╇━━━━━━━━━━━━━╇━━━━━━━━━━╇━━━━━━━━━━━┩ │</span>
<span class="go">│ │ angle                │   0.030      │   0.397     │  174     │   69      │ │</span>
<span class="go">│ │ helical_shift        │    1         │   1.000     │  177     │  177      │ │</span>
<span class="go">│ │ isect                │    2         │   1.000     │ 9677     │ 9677      │ │</span>
<span class="go">│ │ dot_norm             │   0.040      │   0.056     │ 9660     │  540      │ │</span>
<span class="go">│ │ misc_lineuniq        │    1         │ None        │    0     │    0      │ │</span>
<span class="go">│ │ nfold                │   0.300      │   0.800     │    5     │    4      │ │</span>
<span class="go">│ │ seqmatch             │   0.500      │ None        │    0     │    0      │ │</span>
<span class="go">│ │ matchsize            │   50         │ None        │    0     │    0      │ │</span>
<span class="go">│ │ rms_fit              │    4         │ None        │    0     │    0      │ │</span>
<span class="go">│ │ cageang              │   0.050      │   0.250     │    4     │    1      │ │</span>
<span class="go">│ └──────────────────────┴──────────────┴─────────────┴──────────┴───────────┘ │</span>
<span class="go">│ ┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━━┓ │</span>
<span class="go">│ ┃ worst seq match                             ┃ worst rms                  ┃ │</span>
<span class="go">│ ┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━━┩ │</span>
<span class="go">│ │   1.000                                     │   0.000                    │ │</span>
<span class="go">│ └─────────────────────────────────────────────┴────────────────────────────┘ │</span>
<span class="go">└──────────────────────────────────────────────────────────────────────────────┘</span>
</pre></div>
</div>
</section>
<section id="symmetry-detection-pipeline">
<h2><a class="toc-backref" href="#id4" role="doc-backlink">Symmetry Detection Pipeline</a><a class="headerlink" href="#symmetry-detection-pipeline" title="Link to this heading">#</a></h2>
<ol class="arabic">
<li><p><strong>Input Preparation</strong>
Frames or AtomArrays are preprocessed. If <cite>order</cite> is not given, chains are split automatically.</p></li>
<li><p><strong>Component Extraction</strong>
Chains are clustered using <cite>find_components_by_seqaln_rmsfit()</cite> to find unique biological units and generate frames between them.</p></li>
<li><p><strong>Symmetry Element Extraction</strong>
Given transformation frames, pairwise transforms are computed. Each transform is decomposed into axis, angle, center, and helical shift:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">axis</span><span class="p">,</span> <span class="n">ang</span><span class="p">,</span> <span class="n">cen</span><span class="p">,</span> <span class="n">hel</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">axis_angle_cen_hel</span><span class="p">(</span><span class="n">frames</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Axis Deduplication</strong>
Close or redundant axes are grouped using:</p>
<p><a class="reference internal" href="../_apidoc/ipd.homog.hgeom.html#ipd.homog.hgeom.unique_symaxes" title="ipd.homog.hgeom.unique_symaxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.homog.hgeom.unique_symaxes()</span></code></a></p>
<p>This collapses symmetry elements that are equivalent under a tolerance.</p>
</li>
<li><p><strong>Classification</strong>
Symmetry is labeled based on:</p>
<ul class="simple">
<li><p>Angular relationships between axes</p></li>
<li><p>Number of folds (e.g., C3 = 3-fold cyclic)</p></li>
<li><p>Whether symmetry is point, 1D/2D, helical, etc.</p></li>
</ul>
</li>
</ol>
<section id="unique-symaxes">
<h3><a class="toc-backref" href="#id5" role="doc-backlink">Unique Symaxes</a><a class="headerlink" href="#unique-symaxes" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="../_apidoc/ipd.homog.hgeom.html#ipd.homog.hgeom.unique_symaxes" title="ipd.homog.hgeom.unique_symaxes"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.homog.hgeom.unique_symaxes()</span></code></a></p>
<p>This function filters a list of axis/center/angle tuples into unique representatives across frames. It considers:</p>
<ul class="simple">
<li><p>Axis alignment (<cite>dot_norm</cite>)</p></li>
<li><p>Closest approach (<cite>isect</cite>)</p></li>
<li><p>Angular similarity (<cite>angle</cite>)</p></li>
<li><p>Helical shift (<cite>helical_shift</cite>)</p></li>
<li><p>Optional attributes like <cite>nfold</cite>, etc.</p></li>
</ul>
<p>It supports two modes:</p>
<ul class="simple">
<li><p><cite>closest</cite>: pick the line closest to a target</p></li>
<li><p><cite>symaverage</cite>: average close lines across symmetric copies</p></li>
</ul>
</section>
<section id="symmetry-from-atoms">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Symmetry from Atoms</a><a class="headerlink" href="#symmetry-from-atoms" title="Link to this heading">#</a></h3>
<p>If given a list of AtomArrays, <cite>detect()</cite> aligns them using sequence alignment and RMS fitting, then derives symmetry frames. This is managed by:</p>
<p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.syminfo_from_atomslist" title="ipd.sym.sym_detect.syminfo_from_atomslist"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.syminfo_from_atomslist()</span></code></a></p>
<p>Internally, this calls:</p>
<p><a class="reference internal" href="processing_assemblies.html#ipd.atom.find_components_by_seqaln_rmsfit" title="ipd.atom.find_components_by_seqaln_rmsfit"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.atom.find_components_by_seqaln_rmsfit()</span></code></a></p>
</section>
<section id="symmetry-from-frames">
<h3><a class="toc-backref" href="#id7" role="doc-backlink">Symmetry from Frames</a><a class="headerlink" href="#symmetry-from-frames" title="Link to this heading">#</a></h3>
<p>If transformation matrices are already available:</p>
<p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.syminfo_from_frames" title="ipd.sym.sym_detect.syminfo_from_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.syminfo_from_frames()</span></code></a></p>
<p>Frames are decomposed, and redundant symmetry elements are eliminated via:</p>
<p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.symelems_from_frames" title="ipd.sym.sym_detect.symelems_from_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.symelems_from_frames()</span></code></a></p>
<p>This also uses <cite>unique_symaxes</cite> to find canonical axes.</p>
</section>
<section id="the-syminfo-object">
<h3><a class="toc-backref" href="#id8" role="doc-backlink">The SymInfo Object</a><a class="headerlink" href="#the-syminfo-object" title="Link to this heading">#</a></h3>
<p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.detect" title="ipd.sym.sym_detect.detect"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.detect()</span></code></a> returns a <a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.SymInfo" title="ipd.sym.sym_detect.SymInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.SymInfo</span></code></a> instance containing all kinds of info about the symetry detection. <a class="reference internal" href="#printed-syminfo"><span class="std std-ref">Printing</span></a> it will provide a decent summary.</p>
</section>
<section id="advanced-topics">
<h3><a class="toc-backref" href="#id9" role="doc-backlink">Advanced Topics</a><a class="headerlink" href="#advanced-topics" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Tolerances</strong>: Control how similar elements must be to merge.</p></li>
<li><p><strong>Ideal Frames</strong>: Testing with ideal symmetries (C3, D4, T, O, I) helps validate algorithms.</p></li>
<li><p><strong>Point vs Helical Symmetry</strong>: Automatically inferred from presence of translation and axis concurrency.</p></li>
<li><p><strong>Pseudo-order</strong>: Estimated from total transforms and asymmetric units.</p></li>
</ul>
</section>
<section id="related-functions">
<h3><a class="toc-backref" href="#id10" role="doc-backlink">Related Functions</a><a class="headerlink" href="#related-functions" title="Link to this heading">#</a></h3>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.syminfo_from_atomslist" title="ipd.sym.sym_detect.syminfo_from_atomslist"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.syminfo_from_atomslist()</span></code></a></p></li>
<li><p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.syminfo_from_frames" title="ipd.sym.sym_detect.syminfo_from_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.syminfo_from_frames()</span></code></a></p></li>
<li><p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.symelems_from_frames" title="ipd.sym.sym_detect.symelems_from_frames"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.symelems_from_frames()</span></code></a></p></li>
<li><p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.syminfo_get_origin" title="ipd.sym.sym_detect.syminfo_get_origin"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.syminfo_get_origin()</span></code></a></p></li>
<li><p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.syminfo_to_str" title="ipd.sym.sym_detect.syminfo_to_str"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.syminfo_to_str()</span></code></a></p></li>
<li><p><a class="reference internal" href="../_apidoc/ipd.sym.sym_detect.html#ipd.sym.sym_detect.check_sym_combinations" title="ipd.sym.sym_detect.check_sym_combinations"><code class="xref py py-func docutils literal notranslate"><span class="pre">ipd.sym.sym_detect.check_sym_combinations()</span></code></a></p></li>
</ul>
</div></blockquote>
</section>
<section id="conclusion">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Conclusion</a><a class="headerlink" href="#conclusion" title="Link to this heading">#</a></h3>
<p>The symmetry detection system in IPD is highly flexible and powerful. It combines biological sequence matching with geometric reasoning to robustly identify symmetrical assemblies. The use of transform decomposition and axis consolidation enables consistent classification across structures with noise or imperfect symmetry.</p>
</section>
</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="working_with_bodies.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Body and SymBody Objects</p>
      </div>
    </a>
    <a class="right-next"
       href="contact_matrix.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cumulative sums primer and rapid contact matrix processing</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
<div
    id="pst-page-navigation-heading-2"
    class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc" aria-labelledby="pst-page-navigation-heading-2">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#overview">Overview</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#usage-example">Usage Example</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-detection-pipeline">Symmetry Detection Pipeline</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#unique-symaxes">Unique Symaxes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-from-atoms">Symmetry from Atoms</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#symmetry-from-frames">Symmetry from Frames</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#the-syminfo-object">The SymInfo Object</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#advanced-topics">Advanced Topics</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#related-functions">Related Functions</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#conclusion">Conclusion</a></li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/tutorials/symmetry_detection.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 8.2.3.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  <!-- # L10n: Setting the PST URL as an argument as this does not need to be localized -->
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.16.1.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>